load("@rules_erlang//:erlc_opts_file.bzl", "erlc_opts_file")
load("@rules_erlang//:erlang_app_sources.bzl", "erlang_app_sources")

erlc_opts_file(
    name = "erlc_opts_file",
    values = select({
        "@rules_erlang//:debug_build": [
            "+debug_info",
            "-DBUILD_WITHOUT_QUIC",
        ],
        "//conditions:default": [
            "+debug_info",
            "+deterministic",
            "-DBUILD_WITHOUT_QUIC",
        ],
    }),
    out = "erlc_opts",
)

erlang_app_sources(
    name = "srcs",
    app_name = "emqtt",
    erlc_opts_file = ":erlc_opts_file",
    visibility = ["//visibility:public"],
)
